<!DOCTYPE html>
<html>

<script type="text/javascript">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?57788da7d7b941eccd9eaa05422c29fe";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</script>

<head>
  <meta charset="utf-8">
  
  <title>JavaScript操作DOM的那些坑 | trigkit4</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="js在操作DOM中存在着许多跨浏览器方面的坑，本文花了我将近一周的时间整理，我将根据实例整理那些大大小小的“坑”。
DOM的工作模式是：先加载文档的静态内容、再以动态方式对它们进行刷新，动态刷新不影响文档的静态内容。
PS：IE 中的所有 DOM 对象都是以 COM 对象的形式实现的，这意味着 IE 中的 DOM可能会和其他浏览器有一定的差异。">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript操作DOM的那些坑">
<meta property="og:url" content="hawx1993.github.io/2015/08/21/js-dom/index.html">
<meta property="og:site_name" content="trigkit4">
<meta property="og:description" content="js在操作DOM中存在着许多跨浏览器方面的坑，本文花了我将近一周的时间整理，我将根据实例整理那些大大小小的“坑”。
DOM的工作模式是：先加载文档的静态内容、再以动态方式对它们进行刷新，动态刷新不影响文档的静态内容。
PS：IE 中的所有 DOM 对象都是以 COM 对象的形式实现的，这意味着 IE 中的 DOM可能会和其他浏览器有一定的差异。">
<meta property="og:image" content="hawx1993.github.io/img/bVlyeX">
<meta property="og:image" content="hawx1993.github.io/img/bVlsqp">
<meta property="og:image" content="hawx1993.github.io/img/bVlsqs">
<meta property="og:image" content="hawx1993.github.io/img/bVlllS">
<meta property="og:updated_time" content="2015-08-21T07:32:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript操作DOM的那些坑">
<meta name="twitter:description" content="js在操作DOM中存在着许多跨浏览器方面的坑，本文花了我将近一周的时间整理，我将根据实例整理那些大大小小的“坑”。
DOM的工作模式是：先加载文档的静态内容、再以动态方式对它们进行刷新，动态刷新不影响文档的静态内容。
PS：IE 中的所有 DOM 对象都是以 COM 对象的形式实现的，这意味着 IE 中的 DOM可能会和其他浏览器有一定的差异。">
  
    <link rel="alternative" href="/atom.xml" title="trigkit4" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/me.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">trigkit4</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/随笔">随笔</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/hawx1993" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/hwax1993" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/trigkit4" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/Zepto/" style="font-size: 10px;">Zepto</a> <a href="/tags/bower/" style="font-size: 10px;">bower</a> <a href="/tags/broserify/" style="font-size: 10px;">broserify</a> <a href="/tags/browser/" style="font-size: 10px;">browser</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/grunt/" style="font-size: 10px;">grunt</a> <a href="/tags/gulp/" style="font-size: 10px;">gulp</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/前端/" style="font-size: 20px;">前端</a> <a href="/tags/框架/" style="font-size: 10px;">框架</a> <a href="/tags/源码/" style="font-size: 10px;">源码</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://segmentfault.com/u/trigkit4/">trigkit4</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">美团网前端开发实习生，微信：hawx1993</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">trigkit4</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/me.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">trigkit4</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/hawx1993" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/hwax1993" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/trigkit4" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-js-dom" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/08/21/js-dom/" class="article-date">
  	<time datetime="2015-08-21T07:32:26.000Z" itemprop="datePublished">2015-08-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JavaScript操作DOM的那些坑
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DOM/">DOM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/browser/">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>js</code>在操作<code>DOM</code>中存在着许多跨浏览器方面的坑，本文花了我将近一周的时间整理，我将根据实例整理那些大大小小的“坑”。</p>
<p><code>DOM</code>的工作模式是：先加载文档的静态内容、再以动态方式对它们进行刷新，动态刷新不影响文档的静态内容。</p>
<p>PS：<code>IE</code> 中的所有 <code>DOM</code> 对象都是以 <code>COM</code> 对象的形式实现的，这意味着 <code>IE</code> 中的 <code>DOM</code>可能会和其他浏览器有一定的差异。<br><a id="more"></a></p>
<h2 id="Node_接口">Node 接口</h2><table>
<thead>
<tr>
<th>特性/方法</th>
<th style="text-align:center">类型/返回类型</th>
<th style="text-align:right">说    明</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodeName</td>
<td style="text-align:center">String</td>
<td style="text-align:right">节点的名字；根据节点的类型而定义</td>
</tr>
<tr>
<td>nodeValue</td>
<td style="text-align:center">String</td>
<td style="text-align:right">节点的值；根据节点的类型而定义</td>
</tr>
<tr>
<td>nodeType</td>
<td style="text-align:center">Number</td>
<td style="text-align:right">节点的类型常量值之一</td>
</tr>
<tr>
<td>ownerDocument</td>
<td style="text-align:center">Document</td>
<td style="text-align:right">返回某元素的根元素</td>
</tr>
<tr>
<td>firstChild</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">指向在childNodes列表中的第一个节点</td>
</tr>
<tr>
<td>lastChild</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">指向在childNodes列表中的最后一个节点</td>
</tr>
<tr>
<td>childNodes</td>
<td style="text-align:center">NodeList</td>
<td style="text-align:right">所有子节点的列表</td>
</tr>
<tr>
<td>previousSibling</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">返回选定节点的上一个同级节点，若不存在，则返回null</td>
</tr>
<tr>
<td>nextSibling</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">返回被选节点的下一个同级节点，若不存在，则返回null</td>
</tr>
<tr>
<td>hasChildNodes()</td>
<td style="text-align:center">Boolean</td>
<td style="text-align:right">如果当前元素节点拥有子节点，返回true，否则返回false</td>
</tr>
<tr>
<td>attributes</td>
<td style="text-align:center">NamedNodeMap</td>
<td style="text-align:right">返回包含被选节点属性的 NamedNodeMap</td>
</tr>
<tr>
<td>appendChild(node)</td>
<td style="text-align:center">node</td>
<td style="text-align:right">将node添加到childNodes的末尾</td>
</tr>
<tr>
<td>removeChild(node)</td>
<td style="text-align:center">node</td>
<td style="text-align:right">从childNodes中删除node</td>
</tr>
<tr>
<td>replaceChild(newnode, oldnode)</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">将childNodes中的oldnode替换成newnode</td>
</tr>
<tr>
<td>insertBefore</td>
<td style="text-align:center">Node</td>
<td style="text-align:right">在已有子节点之前插入新的子节点</td>
</tr>
</tbody>
</table>
<p><code>firstChild</code> 相当于 <code>childNodes[0]</code>；<code>lastChild</code> 相当于<code>childNodes[box.childNodes.length - 1]</code>。</p>
<p>###nodeType返回结点的类型    </p>
<pre><code>-<span class="ruby">-元素结点返回<span class="number">1</span>
</span>-<span class="ruby">-属性结点返回<span class="number">2</span>
</span>-<span class="ruby">-文本结点返回<span class="number">3</span> </span>
</code></pre><p>###innerHTML 和 nodeValue </p>
<pre><code>对于文本节点，nodeValue 属性包含文本。

对于属性节点，nodeValue 属性包含属性值。

nodeValue 属性对于文档节点和元素节点是不可用的。
</code></pre><p><strong>两者区别</strong>    </p>
<pre><code>box.childNodes[<span class="number">0</span>].nodeValue = <span class="comment">'<span class="xmlDocTag">&lt;strong&gt;</span>abc<span class="xmlDocTag">&lt;/strong&gt;</span>';//结果为：<span class="xmlDocTag">&lt;strong&gt;</span>abc<span class="xmlDocTag">&lt;/strong&gt;</span></span>
abcbox.innerHTML = <span class="comment">'<span class="xmlDocTag">&lt;strong&gt;</span>abc<span class="xmlDocTag">&lt;/strong&gt;</span>';//结果为：abc</span>
</code></pre><p>###nodeName属性获得结点名称</p>
<pre><code>-<span class="ruby">-对于元素结点返回的是标记名称,如：&lt;a herf&gt;&lt;a&gt;返回的是<span class="string">"a"</span>
</span>-<span class="ruby">-对于属性结点返回的是属性名称,如：<span class="class"><span class="keyword">class</span>="<span class="title">test</span>" 返回的是<span class="title">test</span></span>
</span>-<span class="ruby">-对于文本结点返回的是文本的内容 </span>
</code></pre><p>###tagName<br>    document.getElementByTagName(tagName)：返回一个数组，包含对这些结点的引用<br><code>getElementsByTagName()</code>方法将返回一个对象数组 <code>HTMLCollection(NodeList)</code>，这个数组保存着所有相同元素名的节点列表。</p>
<pre><code><span class="built_in">document</span>.getElementsByTagName(<span class="string">'*'</span>);<span class="comment">//获取所有元素</span>
</code></pre><p>PS：<code>IE</code> 浏览器在使用通配符的时候，会把文档最开始的 <code>html</code> 的规范声明当作第一个元素节点。</p>
<pre><code><span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>);<span class="comment">//获取所有 li 元素，返回数组</span>
<span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>)[<span class="number">0</span>];<span class="comment">//获取第一个 li 元素，HTMLLIElement</span>
<span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>).item(<span class="number">0</span>);<span class="comment">//获取第一个 li 元素，HTMLLIElement</span>
<span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>).length;<span class="comment">//获取所有 li 元素的数目</span>
</code></pre><p>###节点的绝对引用：</p>
<pre><code>返回文档的根节点：document<span class="class">.documentElement</span>
返回当前文档中被击活的标签节点：document<span class="class">.activeElement</span>
返回鼠标移出的源节点：event<span class="class">.fromElement</span>
返回鼠标移入的源节点：event<span class="class">.toElement</span>
返回激活事件的源节点：event.srcElement
</code></pre><p>###节点的相对引用：(设当前对节点为node)</p>
<pre><code>返回父节点：node.parentNode <span class="string">|| node.parentElement（IE）</span>
返回子节点集合（包含文本节点及标签节点）：node.childNodes
返回子标签节点集合：node.children
返回子文本节点集合：node.textNodes
返回第一个子节点：node.firstChild
返回最后一个子节点：node.lastChild
返回同属下一个节点：node.nextSibling
返回同属上一个节点：node.previousSibling 
</code></pre><p>###节点信息</p>
<pre><code>是否包含某节点：node.<span class="function"><span class="title">contains</span><span class="params">()</span></span>

是否有子节点node.<span class="function"><span class="title">hasChildNodes</span><span class="params">()</span></span> 
</code></pre><p>###创建新节点</p>
<pre><code><span class="function"><span class="title">createDocumentFragment</span><span class="params">()</span></span>－－创建文档碎片节点
<span class="function"><span class="title">createElement</span><span class="params">(tagname)</span></span>－－创建标签名为tagname的元素
<span class="function"><span class="title">createTextNode</span><span class="params">(text)</span></span>－－创建包含文本text的文本节点
</code></pre><h2 id="获取鼠标点击事件的位置">获取鼠标点击事件的位置</h2><pre><code><span class="built_in">document</span>.onclick = mouseClick;

<span class="function"><span class="keyword">function</span> <span class="title">mouseClick</span>(<span class="params">ev</span>)</span>{
    ev = ev || <span class="built_in">window</span>.event;<span class="comment">//window.event用来兼容IE</span>
    <span class="keyword">var</span> x = <span class="number">0</span>; <span class="keyword">var</span> y = <span class="number">0</span>;

    <span class="keyword">if</span>(ev.pageX){
        x = ev.pageX;
        y = ev.pageY;
    }<span class="keyword">else</span> <span class="keyword">if</span>(ev.clientX){
        <span class="keyword">var</span> offsetX = <span class="number">0</span> , offsetY = <span class="number">0</span>;
        <span class="keyword">if</span>(<span class="built_in">document</span>.documentElement.scrollLeft){
            offsetX = <span class="built_in">document</span>.documentElement.scrollLeft;
            offsetY = <span class="built_in">document</span>.documentElement.scrollTop;
        }<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">document</span>.body){
            offsetX = <span class="built_in">document</span>.body.scrollLeft;
            offsetY = <span class="built_in">document</span>.body.scrollTop;
        }
        x = ev.clientX + offsetX;
        y = ev.clientY + offsetY;
    }
    alert(<span class="string">"你点击的位置是 x="</span>+ x + <span class="string">" y="</span> + y);
}
</code></pre><p>以下所描述的属性在<code>chrome</code>和<code>Safari</code> 都很给力的支持了。</p>
<p>问题一：<code>Firefox</code>，<code>Chrome</code>、<code>Safari</code>和<code>IE9</code>都是通过非标准事件的<code>pageX</code>和<code>pageY</code>属性来获取web页面的鼠标位置的。<code>pageX/Y</code>获取到的是触发点相对文档区域左上角距离，以页面为参考点，不随滑动条移动而变化</p>
<p>问题二：在IE 中，<code>event</code> 对象有 <code>x</code>, <code>y</code> 属性（事件发生的位置的 <code>x</code> 坐标和 <code>y</code> 坐标）火狐中没有。在火狐中，与<code>event.x</code> 等效的是 <code>event.pageX</code>。<code>event.clientX</code> 与 <code>event.pageX</code> 有微妙的差别（当整个页面有滚动条的时候），不过大多数时候是等效的。 </p>
<p><code>offsetX</code>:<code>IE</code>特有，<code>chrome</code>也支持。鼠标相比较于触发事件的元素的位置,以元素盒子模型的内容区域的左上角为参考点,如果有<code>boder</code>,可能出现负值</p>
<p>问题三：<br><code>scrollTop</code>为滚动条向下移动的距离，所有浏览器都支持<code>document.documentElement</code>。</p>
<p>其余参照：<a href="http://segmentfault.com/a/1190000002559158#articleHeader11" target="_blank" rel="external">http://segmentfault.com/a/1190000002559158#articleHeader11</a></p>
<p>###参照表<br>（<code>+</code>为支持，<code>-</code>为不支持）：</p>
<pre><code>offsetX/offsetY：W3C- IE+ Firefox- Opera+ Safari+ chrome+

x/y：W3C- IE+ Firefox- Opera+ Safari+ chrome+

layerX/layerY：W3C- IE- Firefox+ Opera- Safari+ chrome+

pageX/pageY：W3C- IE- Firefox+ Opera+ Safari+ chrome+

clientX/clientY：W3C+ IE+ Firefox+ Opera+ Safari+ chrome+

<span class="built_in">screenX</span>/<span class="built_in">screenY</span>：W3C+ IE+ Firefox+ Opera+ Safari+ chrome+
</code></pre><p>查看下方<code>DEMO</code>：<br>你会发现<code>offsetX</code>在<code>Firefox</code>下是<code>undefined</code>，在<code>chrome</code>和<code>IE</code>则会正常显示。</p>
<p><a href="https://jsfiddle.net/f4am208m/embedded/result/" target="_blank" rel="external">https://jsfiddle.net/f4am208m/embedded/result/</a></p>
<p><img src="/img/bVlyeX" alt="图片描述"></p>
<p>###offsetLeft和style.left区别</p>
<pre><code><span class="number">1</span><span class="class">.style</span><span class="class">.left</span>返回的是字符串，比如<span class="number">10px</span>。而offsetLeft返回的是数值，比如数值<span class="number">10</span>

<span class="number">2</span><span class="class">.style</span><span class="class">.left</span>是可读写的，offsetLeft是只读的

<span class="number">3</span><span class="class">.style</span><span class="class">.left</span>的值需要事先定义(在样式表中定义无效，只能取到在html中定义的值)，否则取到的值是空的
</code></pre><h2 id="getComputedStyle与currentStyle">getComputedStyle与currentStyle</h2><p><code>getComputedStyle()</code>接受两个参数：要取得计算样式的元素和一个伪元素，如果不需要伪元素，则可以是<code>null</code>。然而，在IE中，并不支持<code>getComputedStyle</code>，IE提供了<code>currentStyle</code>属性。</p>
<p><code>getComputedStyle(obj , false )</code> 是支持 w3c (FF12、chrome 14、safari)：在FF新版本中只需要第一个参数，即操作对象，第二个参数写“false”也是大家通用的写法，目的是为了兼容老版本的火狐浏览器。<br>缺点:在标准浏览器中正常，但在IE6/7/8中不支持</p>
<pre><code> <span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{
    <span class="keyword">var</span> oBtn=<span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);
    <span class="keyword">var</span> oDiv=<span class="built_in">document</span>.getElementById(<span class="string">'div1'</span>);

    oBtn.onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{
        <span class="comment">//alert(oDiv.style.width); //写在样式表里无法读取，只能得到写在行内的</span>
        <span class="comment">//alert(getComputedStyle(oDiv).width); //适用于标准浏览器       IE6、7、8不识别</span>
        <span class="comment">//alert(oDiv.currentStyle.width); //适用于IE浏览器，标准浏览器不识别</span>
        <span class="keyword">if</span>(oDiv.currentStyle){
            alert(oDiv.currentStyle.width);
        }<span class="keyword">else</span>{
            alert(getComputedStyle(oDiv).width);
        }

    };
};
</code></pre><h2 id="取消表单提交">取消表单提交</h2><pre><code>&lt;script type=<span class="string">"text/javascript"</span>&gt;
    <span class="function"><span class="keyword">function</span> <span class="title">listenEvent</span><span class="params">(eventObj,event,eventHandler)</span>{</span>
        <span class="keyword">if</span><span class="params">(eventObj.addEventListener)</span>{
            eventObj.addEventListener<span class="params">(event,eventHandler,<span class="literal">false</span>)</span>;
        }<span class="keyword">else</span> <span class="keyword">if</span><span class="params">(eventObj.attachEvent)</span>{
            event = <span class="string">"on"</span> + event;
            eventObj.attachEvent<span class="params">(event,eventHandler)</span>;
        }<span class="keyword">else</span>{
            eventObj[<span class="string">"on"</span> + event] = eventHandler;
        }
    }

    <span class="function"><span class="keyword">function</span> <span class="title">cancelEvent</span><span class="params">(event)</span>{</span>
        <span class="keyword">if</span><span class="params">(event.preventDefault)</span>{
            event.preventDefault<span class="params">()</span>;<span class="comment">//w3c</span>
        }<span class="keyword">else</span>{
            event.returnValue = <span class="literal">true</span>;<span class="comment">//IE</span>
        }
    }

    window.onload = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        var form = document.forms[<span class="string">"picker"</span>];
        listenEvent<span class="params">(form,<span class="string">"submit"</span>,validateFields)</span>;
    };

    <span class="function"><span class="keyword">function</span> <span class="title">validateFields</span><span class="params">(evt)</span>{</span>
        evt = evt ? evt : window.event;
        ...
        <span class="keyword">if</span><span class="params">(invalid)</span>{
            cancelEvent<span class="params">(evt)</span>;
        }
    }
&lt;/script&gt;
</code></pre><h2 id="确定浏览器窗口的尺寸">确定浏览器窗口的尺寸</h2><p>对于主流浏览器来说，比如<code>IE9</code>、<code>Firefox</code>，<code>Chrome</code>和<code>Safari</code>，支持名为<code>innerWidth</code> 和 <code>innerHeight</code>的窗口对象属性，它返回窗口的视口区域，减去任何滚动条的大小。<code>IE</code>不支持<code>innerWidth</code> 和 <code>innerHeight</code></p>
<pre><code><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="function"><span class="keyword">function</span> <span class="title">size</span>(<span class="params"></span>)</span>{
        <span class="keyword">var</span> w = <span class="number">0</span>, h=<span class="number">0</span>;

        <span class="keyword">if</span>(!<span class="built_in">window</span>.innerWidth){
            w = (<span class="built_in">document</span>.documentElement.clientWidth ? <span class="built_in">document</span>.documentElement.clientWidth : <span class="built_in">document</span>.body.clientWidth);

            h = (<span class="built_in">document</span>.documentElement.clientHeight ? <span class="built_in">document</span>.documentElement.clientHeight : <span class="built_in">document</span>.body.clientHeight);
        }<span class="keyword">else</span>{
            w = <span class="built_in">window</span>.innerWidth;
            h = <span class="built_in">window</span>.innerHeight;
        }
        <span class="keyword">return</span> {width:w,height:h};
    }

    <span class="built_in">console</span>.log(size());<span class="comment">//Object { width: 1366, height: 633 }</span>
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
</code></pre><p>实用的 <code>JavaScript</code> 方案（涵盖所有浏览器）： </p>
<pre><code><span class="keyword">var</span> w=<span class="built_in">window</span>.innerWidth || <span class="built_in">document</span>.documentElement.clientWidth || <span class="built_in">document</span>.body.clientWidth;

<span class="keyword">var</span> h=<span class="built_in">window</span>.innerHeight || <span class="built_in">document</span>.documentElement.clientHeight|| <span class="built_in">document</span>.body.clientHeight;
</code></pre><p>对于 IE 6、7、8的方案如下：</p>
<pre><code>document<span class="class">.documentElement</span><span class="class">.clientHeight</span>
document<span class="class">.documentElement</span><span class="class">.clientWidth</span>
</code></pre><p>或者</p>
<pre><code>document<span class="class">.body</span><span class="class">.clientHeight</span>
document<span class="class">.body</span><span class="class">.clientWidth</span>
</code></pre><p><code>Document</code>对象的<code>body</code>属性对应<code>HTML</code>文档的<code>&lt;body&gt;</code>标签。<code>Document</code>对象的<code>documentElement</code>属性则表示 <code>HTML</code>文档的根节点。 </p>
<h2 id="attributes_属性">attributes 属性</h2><p><code>attributes</code> 属性返回该节点的属性节点集合。</p>
<pre><code><span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes<span class="comment">//NamedNodeMap</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes.length;<span class="comment">//返回属性节点个数</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes[<span class="number">0</span>]; <span class="comment">//Attr，返回最后一个属性节点</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes[<span class="number">0</span>].nodeType; <span class="comment">//2，节点类型</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes[<span class="number">0</span>].nodeValue; <span class="comment">//属性值</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes[<span class="string">'id'</span>]; <span class="comment">//Attr，返回属性为 id 的节点</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).attributes.getNamedItem(<span class="string">'id'</span>); <span class="comment">//Attr</span>
</code></pre><h2 id="setAttribute_和_getAttribute">setAttribute 和 getAttribute</h2><p>在<code>IE</code>中是不认识<code>class</code>属性的，需改为<code>className</code>属性，同样，在<code>Firefox</code>中，也是不认识<code>className</code>属性的，<code>Firefox</code>只认识<code>class</code>属性，所以通常做法如下：</p>
<pre><code><span class="keyword">element</span>.setAttribute(class, <span class="built_in">value</span>); <span class="comment"> //for firefox</span>
<span class="keyword">element</span>.setAttribute(className, <span class="built_in">value</span>); <span class="comment"> //for IE</span>
</code></pre><p><code>IE：</code>可以使用获取常规属性的方法来获取自定义属性,也可以使用<code>getAttribute()</code>获取自定义属性<br><code>Firefox</code>：只能使用<code>getAttribute()</code>获取自定义属性.</p>
<p>解决方法：统一通过<code>getAttribute()</code>获取自定义属性</p>
<pre><code><span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).getAttribute(<span class="string">'id'</span>);<span class="comment">//获取元素的 id 值</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).id;<span class="comment">//获取元素的 id 值</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).getAttribute(<span class="string">'mydiv'</span>);<span class="comment">//获取元素的自定义属性值</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).mydiv<span class="comment">//获取元素的自定义属性值， IE 不支持非</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).getAttribute(<span class="string">'class'</span>);<span class="comment">//获取元素的 class 值，IE 不支持</span>
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).getAttribute(<span class="string">'className'</span>);<span class="comment">//非 IE 不支持</span>
</code></pre><p>PS：在 <code>IE7</code> 及更低版本的IE浏览器中，使用 <code>setAttribute()</code>方法设置 <code>class</code> 和 <code>style</code> 属性是没有效果的，虽然 <code>IE8</code> 解决了这个 <code>bug</code>，但还是不建议使用。</p>
<h2 id="removeAttribute()方法">removeAttribute()方法</h2><pre><code>removeAttribute()可以移除 HTML 属性。
<span class="built_in">document</span>.getElementById(<span class="string">'box'</span>).removeAttribute(<span class="string">'style'</span>);<span class="comment">//移除属性</span>
</code></pre><p>PS：<code>IE6</code> 及更低版本不支持 <code>removeAttribute()</code>方法。</p>
<h2 id="跨浏览器事件Event对象">跨浏览器事件Event对象</h2><pre><code><span class="doctype">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css">
       <span class="id">#drop</span><span class="rules">{
           <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">300px</span></span></span>;
           <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">200px</span></span></span>;
           <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#ff0000</span></span></span>;
           <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">5px</span></span></span>;
           <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">2px</span> solid <span class="hexcolor">#000000</span></span></span>;
       }</span>
       <span class="id">#item</span><span class="rules">{
           <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;
           <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>;
           <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#ffff00</span></span></span>;
           <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">5px</span></span></span>;
           <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">20px</span></span></span>;
           <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> dashed black</span></span>;
       }</span>
       *<span class="attr_selector">[draggable = true]</span><span class="rules">{
           <span class="rule"><span class="attribute">-moz-user-select</span>:<span class="value"> none</span></span>;
           <span class="rule"><span class="attribute">-webkit-user-select</span>:<span class="value"> none</span></span>;
           <span class="rule"><span class="attribute">cursor</span>:<span class="value"> move</span></span>;
       }</span>
    </span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>将金黄色的小方块拖到红色的大方块中，不兼容IE7及以下浏览器，兼容主流浏览器！<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"item"</span> <span class="attribute">draggable</span>=<span class="value">"true"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"drop"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="function"><span class="keyword">function</span> <span class="title">listenEvent</span>(<span class="params">target,type,handler</span>)</span>{
        <span class="keyword">if</span>(target.addEventListener){<span class="comment">//w3c</span>
            target.addEventListener(type,handler,<span class="literal">false</span>);
        }<span class="keyword">else</span> <span class="keyword">if</span>(target.attachEvent){<span class="comment">//IE</span>
            type = <span class="string">"on"</span> + type;
            target.attachEvent(type,handler);<span class="comment">//IE</span>
        }<span class="keyword">else</span>{
            target[<span class="string">"on"</span> + type] = handler;
        }
    }

    <span class="comment">//取消事件</span>
    <span class="function"><span class="keyword">function</span> <span class="title">cancelEvent</span>(<span class="params">e</span>)</span>{
        <span class="keyword">if</span>(e.preventDefault){
            e.preventDefault();<span class="comment">//w3c</span>
        }<span class="keyword">else</span>{
            e.returnValue = <span class="literal">false</span>;<span class="comment">//IE</span>
        }
    }
    <span class="comment">//取消传递</span>
    <span class="function"><span class="keyword">function</span> <span class="title">cancelPropagation</span>(<span class="params">e</span>)</span>{
        <span class="keyword">if</span>(e.stopPropagation){
            e.stopPropagation();<span class="comment">//w3c</span>
        }<span class="keyword">else</span>{
            e.cancelBubble = <span class="literal">true</span>;<span class="comment">//IE</span>
        }
    }

    <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
        <span class="keyword">var</span> target = <span class="built_in">document</span>.getElementById(<span class="string">'drop'</span>);
        listenEvent(target,<span class="string">'dragenter'</span>,cancelEvent);
        listenEvent(target,<span class="string">"dragover"</span>,dragOver);
        listenEvent(target,<span class="string">'drop'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>{
            cancelPropagation(evt);
            evt = evt || <span class="built_in">window</span>.event;
            evt.dataTransfer.dropEffect = <span class="string">'copy'</span>;
            <span class="keyword">var</span> id = evt.dataTransfer.getData(<span class="string">'Text'</span>);
            target.appendChild(<span class="built_in">document</span>.getElementById(id));
        });

        <span class="keyword">var</span> item = <span class="built_in">document</span>.getElementById(<span class="string">'item'</span>);
        item.setAttribute(<span class="string">"draggable"</span>,<span class="string">'true'</span>);
        listenEvent(item,<span class="string">'dragstart'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>{
            evt = evt || <span class="built_in">window</span>.event;
            evt.dataTransfer.effectAllowed = <span class="string">'copy'</span>;
            evt.dataTransfer.setData(<span class="string">'Text'</span>,item.id);
        });
    };

    <span class="function"><span class="keyword">function</span> <span class="title">dragOver</span>(<span class="params">evt</span>)</span>{
        <span class="keyword">if</span>(evt.preventDefault) evt.preventDefault();
        evt = evt || <span class="built_in">window</span>.event;
        evt.dataTransfer.dropEffect = <span class="string">'copy'</span>;
        <span class="keyword">return</span> <span class="literal">false</span>;
    }
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre><p>###dataTransfer 对象    </p>
<table>
<thead>
<tr>
<th>属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>dropEffect</td>
<td style="text-align:center">设置或获取拖曳操作的类型和要显示的光标类型</td>
</tr>
<tr>
<td>effectAllowed</td>
<td style="text-align:center">设置或获取数据传送操作可应用于该对象的源元素</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>方法</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>clearData</td>
<td style="text-align:center">通过 dataTransfer 或 clipboardData 对象从剪贴板删除一种或多种数据格式</td>
</tr>
<tr>
<td>getData</td>
<td style="text-align:center">通过 dataTransfer 或 clipboardData 对象从剪贴板获取指定格式的数据</td>
</tr>
<tr>
<td>setData</td>
<td style="text-align:center">以指定格式给 dataTransfer 或 clipboardData 对象赋予数据</td>
</tr>
</tbody>
</table>
<p>###HTML5拖拽的浏览器支持</p>
<p><code>Internet Explorer 9、Firefox、Opera 12、Chrome</code> 以及 <code>Safari 5</code> 支持拖放    </p>
<p>为了使元素可拖动，需把 <code>draggable</code> 属性设置为 <code>true</code> ：</p>
<pre><code>&lt;<span class="tag">img</span> draggable=<span class="string">"true"</span> /&gt;
</code></pre><table>
<thead>
<tr>
<th>事件</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>dragstart</td>
<td style="text-align:center">拖拽事件开始</td>
</tr>
<tr>
<td>drag</td>
<td style="text-align:center">在拖动操作上</td>
</tr>
<tr>
<td>dragenter</td>
<td style="text-align:center">拖动到目标上，用来决定目标是否接受放置</td>
</tr>
<tr>
<td>dragover</td>
<td style="text-align:center">拖动到目标上，用来决定给用户的反馈</td>
</tr>
<tr>
<td>drop</td>
<td style="text-align:center">放置发生</td>
</tr>
<tr>
<td>dragleave</td>
<td style="text-align:center">拖动离开目标   </td>
</tr>
<tr>
<td>dragend</td>
<td style="text-align:center">拖动操作结束</td>
</tr>
</tbody>
</table>
<p>上述代码的一些浏览器兼容性：</p>
<pre><code><span class="number">1</span>.为了兼容IE，我们将<span class="escape">`w</span>indow.event<span class="escape">`赋</span>给 <span class="escape">`e</span>vt<span class="escape">`，</span>其他浏览器则会正确将接收到的<span class="escape">`e</span>vent<span class="escape">`对</span>象赋给<span class="escape">`e</span>vt<span class="escape">`。</span>
<span class="number">2</span>.w3c使用addEventListener来为事件元素添加事件监听器，而IE则使用attachEvent。addEventListener为事件冒泡到的当前对象，而attachEvent是window
<span class="number">3</span>.对于事件类型，IE需要加<span class="escape">`o</span>n + type<span class="escape">`属</span>性，而其他浏览器则不用
<span class="number">4</span>.对于阻止元素的默认事件行为，下面是w3c和IE的做法：

    e.preventDefault()<span class="comment">;//w3c   </span>
    e.returnValue = <span class="literal">false</span><span class="comment">;//IE</span>

<span class="number">5</span>.对于取消事件传播，w3c和IE也有不同的处理机制：
    e.stopPropagation()<span class="comment">;//w3c</span>
    e.cancelBubble = <span class="literal">true</span><span class="comment">;//IE</span>
</code></pre><h2 id="跨浏览器获取目标对象">跨浏览器获取目标对象</h2><pre><code><span class="comment">//跨浏览器获取目标对象</span>
<span class="function"><span class="keyword">function</span> <span class="title">getTarget</span>(<span class="params">ev</span>)</span>{
    <span class="keyword">if</span>(ev.target){<span class="comment">//w3c</span>
        <span class="keyword">return</span> ev.target;
    }<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.event.srcElement){<span class="comment">//IE</span>
        <span class="keyword">return</span> <span class="built_in">window</span>.event.srcElement;
    }
}  
</code></pre><p>对于获取触发事件的对象，<code>w3c</code>和<code>IE</code>也有不同的做法：</p>
<pre><code><span class="keyword">event</span>.target;<span class="comment">//w3c</span>
<span class="keyword">event</span>.srcElement;<span class="comment">//IE       </span>
</code></pre><p>我们可以使用三目运算符来兼容他们：</p>
<pre><code>obj = <span class="keyword">event</span>.srcElement ? <span class="keyword">event</span>.srcElement : <span class="keyword">event</span>.target;
</code></pre><h2 id="innerText的问题">innerText的问题</h2><p><code>innerText</code>在<code>IE</code>中能正常工作，但是<code>innerText</code>在<code>FireFox</code>中却不行。</p>
<pre><code><span class="tag">&lt;<span class="title">p</span> <span class="attribute">id</span>=<span class="value">"element"</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="keyword">if</span>(navigator.appName.indexOf(<span class="string">"Explorer"</span>) &gt;-<span class="number">1</span>){
        <span class="built_in">document</span>.getElementById(<span class="string">'element'</span>).innerText = <span class="string">"my text"</span>;
    } <span class="keyword">else</span>{
        <span class="built_in">document</span>.getElementById(<span class="string">'element'</span>).textContent = <span class="string">"my text"</span>;
    }
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
</code></pre><p>###跨浏览器获取和设置innerText  </p>
<pre><code><span class="comment">//跨浏览器获取innerText</span>
<span class="function"><span class="keyword">function</span> <span class="title">getInnerText</span><span class="params">(element)</span></span>{
    <span class="keyword">return</span> (<span class="keyword">typeof</span> element.textContent == <span class="string">'string'</span>) ? element.textContent : element.innerText;
}

<span class="comment">//跨浏览器设置innerText</span>
<span class="function"><span class="keyword">function</span> <span class="title">setInnerText</span><span class="params">(element,text)</span></span>{
    <span class="keyword">if</span>(<span class="keyword">typeof</span> element.textContent == <span class="string">'string'</span>){
        element.textContent = text;
    }<span class="keyword">else</span>{
        element.innerText = text;
    }
}    
</code></pre><h2 id="oninput,onpropertychange,onchange的用法">oninput,onpropertychange,onchange的用法</h2><p><code>onchange</code>触发事件必须满足两个条件：</p>
<pre><code><span class="literal">a</span>）当前对象属性改变，并且是由键盘或鼠标事件激发的（脚本触发无效）

b）当前对象失去焦点(onblur)；
</code></pre><p><code>onpropertychange</code>的话，只要当前对象属性发生改变，都会触发事件，但是它是IE专属的；</p>
<pre><code>oninput是onpropertychange的非IE浏览器版本，支持firefox和opera等浏览器，但有一点不同，它绑定于对象时，并非该对象所有属性改变都能触发事件，它只在对象<span class="keyword">value</span>值发生改变时奏效。
</code></pre><h2 id="访问XMLHTTPRequest对象">访问XMLHTTPRequest对象</h2><pre><code><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest){
        xhr = <span class="keyword">new</span> XMLHttpRequest();<span class="comment">//非IE</span>
    }<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject){
        xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHttp"</span>);<span class="comment">//IE</span>
    }
</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
</code></pre><h2 id="禁止选取网页内容">禁止选取网页内容</h2><pre><code>问题：  
<span class="tag">FF</span>需要用<span class="tag">CSS</span>禁止，<span class="tag">IE</span>用<span class="tag">JS</span>禁止  

解决方法：  
<span class="rule"><span class="attribute">IE</span>:<span class="value"> obj.onselectstart = <span class="function">function</span>() {return false</span></span>;}  
<span class="rule"><span class="attribute">FF</span>:<span class="value"> -moz-user-select:none</span></span>;   
</code></pre><h2 id="三大不冒泡事件">三大不冒泡事件</h2><p>所有浏览器的<code>focus/blur</code>事件都不冒泡，万幸的是大部分浏览器支持<code>focusin/focusout</code>事件，不过可恶的<code>firefox</code>连这个都不支持。</p>
<pre><code>IE6、<span class="number">7</span>、<span class="number">8</span>下 submit事件不冒泡。
IE6、<span class="number">7</span>、<span class="number">8</span>下 change事件要等到blur时才触发。
</code></pre><h2 id="万恶的滚轮事件">万恶的滚轮事件</h2><p>滚轮事件的支持可谓是乱七八糟，规律如下：</p>
<pre><code>IE6-<span class="number">11</span> chrome mousewheel wheelDetla 下 -<span class="number">120</span> 上 <span class="number">120</span>

firefox DOMMouseScroll detail 下<span class="number">3</span> 上-<span class="number">3</span>

firefox wheel detlaY 下<span class="number">3</span> 上-<span class="number">3</span>

IE9-<span class="number">11</span> wheel deltaY 下<span class="number">40</span> 上-<span class="number">40</span>

chrome wheel deltaY 下<span class="number">100</span> 上-<span class="number">100</span>  
</code></pre><p>关于鼠标滚轮事件，IE支持<code>mousewheel</code>，火狐支持<code>DOMMouseScroll</code>。<br>判断鼠标滚轮是向上还是向下，<code>IE</code>是通过<code>wheelDelta</code>属性，而火狐是通过<code>detail</code>属性</p>
<h2 id="事件委托方法">事件委托方法</h2><pre><code><span class="comment">//事件委托方法  </span>
IE：document.<span class="keyword">body</span>.onload = inject; <span class="comment">//Function inject()在这之前已被实现  </span>
FF：document.<span class="keyword">body</span>.onload = inject();   
</code></pre><h2 id="HTML5_的浏览器支持情况">HTML5 的浏览器支持情况</h2><p> <img src="/img/bVlsqp" alt="图片描述"></p>
<p> <img src="/img/bVlsqs" alt="图片描述"></p>
<blockquote>
<p>来源地址：<a href="http://fmbip.com/litmus/" target="_blank" rel="external">http://fmbip.com/litmus/</a></p>
</blockquote>
<h2 id="查询操作">查询操作</h2><p>查询通过指的是通过一些特征字符串来找到一组元素，或者判断元素是不是满足字符串。</p>
<pre><code><span class="number">1.</span> IE6/<span class="number">7</span>不区分id和nam
在IE6/<span class="number">7</span>下使用getElementById和getElementsByName时会同时返回id或name与给定值相同的元素。由于name通常由后端约定，因此我们在写JS时，应保证id不与name重复。

<span class="number">2.</span> IE6/<span class="number">7</span>不支持getElementsByClassName和querySelectorAll   
这两个函数从IE8开始支持的，因此在IE6/<span class="number">7</span>下，我们实际可以用的只有getElementByTagName。

<span class="number">3.</span> IE6/<span class="number">7</span>不支持getElementsByTagName(<span class="string">'*'</span>)会返回非元素节点    
要么不用*，要么自己写个函数过滤一下。

<span class="number">4.</span> IE8下querySelectorAll对属性选择器不友好    
几乎所有浏览器预定义的属性都有了问题，尽量使用自定义属性或者不用属性选择器。

<span class="number">5.</span> IE8下querySelectorAll不支持伪类    
有时候伪类是很好用，IE8并不支持，jquery提供的:first、:last、:even、:odd、:eq、:nth、:lt、:gt并不是伪类，我们在任何时间都不要使用它们。

<span class="number">6.</span> IE9的matches函数不能处理不在DOM树上的元素
只要元素不在dom树上，一定会返回<span class="literal">false</span>，实在不行把元素丢在body里面匹配完了再删掉吧，当然了我们也可以自己写匹配函数以避免回流。    
</code></pre><p><img src="/img/bVlllS" alt="to be continued..."></p>
<blockquote>
<p>资料参考：<br><a href="http://w3help.org/zh-cn/kb/，" target="_blank" rel="external">http://w3help.org/zh-cn/kb/，</a><br><a href="http://www.zhihu.com/question/29072028" target="_blank" rel="external">http://www.zhihu.com/question/29072028</a></p>
</blockquote>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2015/08/19/grunt/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">grunt和前端模块管理工具的简单使用</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>



<!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
	<a class="jiathis_like_tsina" data="width=120"></a>
	<a class="jiathis_like_qzone"></a>
</div>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=2055108" charset="utf-8"></script>
<!-- JiaThis Button END -->



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="js-dom" data-title="JavaScript操作DOM的那些坑" data-url="hawx1993.github.io/2015/08/21/js-dom/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"trigkit4"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 trigkit4
    	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>